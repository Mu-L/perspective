(self.webpackChunk_finos_perspective_docs=self.webpackChunk_finos_perspective_docs||[]).push([[577],{9577:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ie,init_client:()=>te,init_server:()=>Z,websocket:()=>re,worker:()=>_e});var r=Object.defineProperty,_={};((e,t)=>{for(var n in t)r(e,n,{get:t[n],enumerable:!0})})(_,{Client:()=>B,ProxySession:()=>P,Table:()=>R,View:()=>F,default:()=>H,init:()=>j,initSync:()=>z});var i,o=class extends Error{},s=new Array(128).fill(void 0);function a(e){return s[e]}s.push(void 0,null,!0,!1);var c=0,u=null;function b(){return(null===u||0===u.byteLength)&&(u=new Uint8Array(i.memory.buffer)),u}var f=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},w=function(e,t){return f.encodeInto(e,t)};function g(e,t,n){if(void 0===n){let n=f.encode(e),r=t(n.length,1)>>>0;return b().subarray(r,r+n.length).set(n),c=n.length,r}let r=e.length,_=t(r,1)>>>0,i=b(),o=0;for(;o<r;o++){let t=e.charCodeAt(o);if(t>127)break;i[_+o]=t}if(o!==r){0!==o&&(e=e.slice(o)),_=n(_,r,r=o+3*e.length,1)>>>0;let t=b().subarray(_+o,_+r);o+=w(e,t).written,_=n(_,r,o,1)>>>0}return c=o,_}var l=null;function d(){return(null===l||!0===l.buffer.detached||void 0===l.buffer.detached&&l.buffer!==i.memory.buffer)&&(l=new DataView(i.memory.buffer)),l}var p=s.length;function y(e){p===s.length&&s.push(s.length+1);let t=p;return p=s[t],s[t]=e,t}function h(e,t){try{return e.apply(this,t)}catch(n){i.__wbindgen_export_2(y(n))}}var m=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function v(e,t){return e>>>=0,m.decode(b().subarray(e,e+t))}function x(e){return null==e}function A(e){let t=a(e);return function(e){e<132||(s[e]=p,p=e)}(e),t}typeof TextDecoder<"u"&&m.decode();var k=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>{i.__wbindgen_export_4.get(e.dtor)(e.a,e.b)}));function E(e){let t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){let t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){let t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){let t=e.length,n="[";t>0&&(n+=E(e[0]));for(let r=1;r<t;r++)n+=", "+E(e[r]);return n+="]",n}let n,r=/\[object ([^\]]+)\]/.exec(toString.call(e));if(!(r&&r.length>1))return toString.call(e);if(n=r[1],"Object"==n)try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:n}var I=128;function S(e){if(1==I)throw new Error("out of js stack");return s[--I]=e,I}function j(){i.init()}function O(e,t){return A(i.__wbindgen_export_5(e,t))}function W(e,t,n){i.__wbindgen_export_6(e,t,y(n))}var U=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>i.__wbg_client_free(e>>>0,1))),B=class{static __wrap(e){e>>>=0;let t=Object.create(B.prototype);return t.__wbg_ptr=e,U.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,U.unregister(this),e}free(){let e=this.__destroy_into_raw();i.__wbg_client_free(e,0)}constructor(e,t){let n=i.client_new(y(e),x(t)?0:y(t));return this.__wbg_ptr=n>>>0,U.register(this,this.__wbg_ptr,this),this}new_proxy_session(e){try{let t=i.client_new_proxy_session(this.__wbg_ptr,S(e));return P.__wrap(t)}finally{s[I++]=void 0}}init(){return A(i.client_init(this.__wbg_ptr))}handle_response(e){return A(i.client_handle_response(this.__wbg_ptr,y(e)))}handle_error(e,t){var n=x(e)?0:g(e,i.__wbindgen_export_0,i.__wbindgen_export_1),r=c;return A(i.client_handle_error(this.__wbg_ptr,n,r,x(t)?0:y(t)))}on_error(e){return A(i.client_on_error(this.__wbg_ptr,y(e)))}table(e,t){return A(i.client_table(this.__wbg_ptr,y(e),x(t)?0:y(t)))}terminate(){try{let n=i.__wbindgen_add_to_stack_pointer(-16);i.client_terminate(n,this.__wbg_ptr);var e=d().getInt32(n+0,!0),t=d().getInt32(n+4,!0);if(d().getInt32(n+8,!0))throw A(t);return A(e)}finally{i.__wbindgen_add_to_stack_pointer(16)}}open_table(e){let t=g(e,i.__wbindgen_export_0,i.__wbindgen_export_1),n=c;return A(i.client_open_table(this.__wbg_ptr,t,n))}get_hosted_table_names(){return A(i.client_get_hosted_table_names(this.__wbg_ptr))}system_info(){return A(i.client_system_info(this.__wbg_ptr))}},N=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>i.__wbg_proxysession_free(e>>>0,1))),P=class{static __wrap(e){e>>>=0;let t=Object.create(P.prototype);return t.__wbg_ptr=e,N.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,N.unregister(this),e}free(){let e=this.__destroy_into_raw();i.__wbg_proxysession_free(e,0)}constructor(e,t){try{!function(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}(e,B);let n=i.client_new_proxy_session(e.__wbg_ptr,S(t));return this.__wbg_ptr=n>>>0,N.register(this,this.__wbg_ptr,this),this}finally{s[I++]=void 0}}handle_request(e){return A(i.proxysession_handle_request(this.__wbg_ptr,y(e)))}poll(){return A(i.proxysession_poll(this.__wbg_ptr))}close(){let e=this.__destroy_into_raw();return A(i.proxysession_close(e))}},M=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>i.__wbg_table_free(e>>>0,1))),R=class{static __wrap(e){e>>>=0;let t=Object.create(R.prototype);return t.__wbg_ptr=e,M.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,M.unregister(this),e}free(){let e=this.__destroy_into_raw();i.__wbg_table_free(e,0)}get_index(){return A(i.table_get_index(this.__wbg_ptr))}get_client(){return A(i.table_get_client(this.__wbg_ptr))}get_limit(){return A(i.table_get_limit(this.__wbg_ptr))}clear(){return A(i.table_clear(this.__wbg_ptr))}delete(){return A(i.table_delete(this.__wbg_ptr))}size(){return A(i.table_size(this.__wbg_ptr))}schema(){return A(i.table_schema(this.__wbg_ptr))}columns(){return A(i.table_columns(this.__wbg_ptr))}make_port(){return A(i.table_make_port(this.__wbg_ptr))}on_delete(e){return A(i.table_on_delete(this.__wbg_ptr,y(e)))}remove_delete(e){return A(i.table_remove_delete(this.__wbg_ptr,e))}remove(e,t){return A(i.table_remove(this.__wbg_ptr,y(e),x(t)?0:y(t)))}replace(e,t){return A(i.table_replace(this.__wbg_ptr,y(e),x(t)?0:y(t)))}update(e,t){return A(i.table_update(this.__wbg_ptr,y(e),x(t)?0:y(t)))}view(e){return A(i.table_view(this.__wbg_ptr,x(e)?0:y(e)))}validate_expressions(e){return A(i.table_validate_expressions(this.__wbg_ptr,y(e)))}unsafe_get_model(){return i.table_unsafe_get_model(this.__wbg_ptr)>>>0}},L=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>i.__wbg_view_free(e>>>0,1))),F=class{static __wrap(e){e>>>=0;let t=Object.create(F.prototype);return t.__wbg_ptr=e,L.register(t,t.__wbg_ptr,t),t}static __unwrap(e){return e instanceof F?e.__destroy_into_raw():0}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,L.unregister(this),e}free(){let e=this.__destroy_into_raw();i.__wbg_view_free(e,0)}__get_model(){let e=i.view___get_model(this.__wbg_ptr);return F.__wrap(e)}column_paths(){return A(i.view_column_paths(this.__wbg_ptr))}delete(){return A(i.view_delete(this.__wbg_ptr))}dimensions(){return A(i.view_dimensions(this.__wbg_ptr))}expression_schema(){return A(i.view_expression_schema(this.__wbg_ptr))}get_config(){return A(i.view_get_config(this.__wbg_ptr))}get_min_max(e){let t=g(e,i.__wbindgen_export_0,i.__wbindgen_export_1),n=c;return A(i.view_get_min_max(this.__wbg_ptr,t,n))}num_rows(){return A(i.view_num_rows(this.__wbg_ptr))}schema(){return A(i.view_schema(this.__wbg_ptr))}to_arrow(e){return A(i.view_to_arrow(this.__wbg_ptr,x(e)?0:y(e)))}to_columns_string(e){return A(i.view_to_columns_string(this.__wbg_ptr,x(e)?0:y(e)))}to_columns(e){return A(i.view_to_columns(this.__wbg_ptr,x(e)?0:y(e)))}to_json_string(e){return A(i.view_to_json_string(this.__wbg_ptr,x(e)?0:y(e)))}to_json(e){return A(i.view_to_json(this.__wbg_ptr,x(e)?0:y(e)))}to_ndjson(e){return A(i.view_to_ndjson(this.__wbg_ptr,x(e)?0:y(e)))}to_csv(e){return A(i.view_to_csv(this.__wbg_ptr,x(e)?0:y(e)))}on_update(e,t){return A(i.view_on_update(this.__wbg_ptr,y(e),x(t)?0:y(t)))}remove_update(e){return A(i.view_remove_update(this.__wbg_ptr,e))}on_delete(e){return A(i.view_on_delete(this.__wbg_ptr,y(e)))}num_columns(){return A(i.view_num_columns(this.__wbg_ptr))}remove_delete(e){return A(i.view_remove_delete(this.__wbg_ptr,e))}collapse(e){return A(i.view_collapse(this.__wbg_ptr,e))}expand(e){return A(i.view_expand(this.__wbg_ptr,e))}set_depth(e){return A(i.view_set_depth(this.__wbg_ptr,e))}};function C(){let e={wbg:{}};return e.wbg.__wbg_String_8f0eb39a4a4c2f66=function(e,t){let n=g(String(a(t)),i.__wbindgen_export_0,i.__wbindgen_export_1),r=c;d().setInt32(e+4,r,!0),d().setInt32(e+0,n,!0)},e.wbg.__wbg_at_1abf0efc31a7fc6e=function(e,t){return y(a(e).at(t))},e.wbg.__wbg_buffer_bacd7706db793204=function(e){return y(a(e).buffer)},e.wbg.__wbg_buffer_ef9774282e5dab94=function(e){return y(a(e).buffer)},e.wbg.__wbg_call_0ad083564791763a=function(){return h((function(e,t){return y(a(e).call(a(t)))}),arguments)},e.wbg.__wbg_call_a34b6b4765f27be0=function(){return h((function(e,t,n){return y(a(e).call(a(t),a(n)))}),arguments)},e.wbg.__wbg_call_efe5a4db7065d1a2=function(){return h((function(e,t,n,r){return y(a(e).call(a(t),a(n),a(r)))}),arguments)},e.wbg.__wbg_client_new=function(e){return y(B.__wrap(e))},e.wbg.__wbg_crypto_ed58b8e10a292839=function(e){return y(a(e).crypto)},e.wbg.__wbg_debug_338493c12960e4a7=function(e){console.debug(a(e))},e.wbg.__wbg_debug_f201c091a5d2019b=function(e,t,n,r){console.debug(a(e),a(t),a(n),a(r))},e.wbg.__wbg_done_f4c254830a095eaf=function(e){return a(e).done},e.wbg.__wbg_entries_83beb641792ccb9c=function(e){return y(Object.entries(a(e)))},e.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let n,r;try{n=e,r=t,console.error(v(e,t))}finally{i.__wbindgen_export_3(n,r,1)}},e.wbg.__wbg_error_852b114509bed301=function(e){console.error(a(e))},e.wbg.__wbg_error_94252a8e90b35b8e=function(e,t,n,r){console.error(a(e),a(t),a(n),a(r))},e.wbg.__wbg_error_afd05d3fc1f414ce=function(e,t){console.error(a(e),a(t))},e.wbg.__wbg_from_3aa0fcaa8eef0104=function(e){return y(Array.from(a(e)))},e.wbg.__wbg_getEntriesByName_6fb8ccc67553373f=function(e,t,n,r,_){return y(a(e).getEntriesByName(v(t,n),v(r,_)))},e.wbg.__wbg_getRandomValues_bcb4912f16000dc4=function(){return h((function(e,t){a(e).getRandomValues(a(t))}),arguments)},e.wbg.__wbg_get_0c3cc364764a0b98=function(e,t){return y(a(e)[t>>>0])},e.wbg.__wbg_get_977cbaa63dc20090=function(e,t,n){let r=a(e)[v(t,n)];return x(r)?0:y(r)},e.wbg.__wbg_get_b996a12be035ef4f=function(){return h((function(e,t){return y(Reflect.get(a(e),a(t)))}),arguments)},e.wbg.__wbg_getwithrefkey_1dc361bd10053bfe=function(e,t){return y(a(e)[a(t)])},e.wbg.__wbg_globalThis_6b4d52a0b6aaeaea=function(){return h((function(){return y(globalThis.globalThis)}),arguments)},e.wbg.__wbg_global_49324ce12193de77=function(){return h((function(){return y(global.global)}),arguments)},e.wbg.__wbg_has_bdec43a5ed4cb454=function(){return h((function(e,t){return Reflect.has(a(e),a(t))}),arguments)},e.wbg.__wbg_info_493696cc38ae1ad0=function(e,t,n,r){console.info(a(e),a(t),a(n),a(r))},e.wbg.__wbg_info_6c1abe3d4e1ae962=function(e){console.info(a(e))},e.wbg.__wbg_instanceof_ArrayBuffer_ff40e55b5978e215=function(e){let t;try{t=a(e)instanceof ArrayBuffer}catch{t=!1}return t},e.wbg.__wbg_instanceof_Array_23bc22ecdd4608e6=function(e){let t;try{t=a(e)instanceof Array}catch{t=!1}return t},e.wbg.__wbg_instanceof_Map_0f3f3653f757ced1=function(e){let t;try{t=a(e)instanceof Map}catch{t=!1}return t},e.wbg.__wbg_instanceof_Object_9108547bac1f91b1=function(e){let t;try{t=a(e)instanceof Object}catch{t=!1}return t},e.wbg.__wbg_instanceof_PerspectiveViewNotFoundError_097204e44b2902e9=function(e){let t;try{t=a(e)instanceof o}catch{t=!1}return t},e.wbg.__wbg_instanceof_Uint8Array_db97368f94b1373f=function(e){let t;try{t=a(e)instanceof Uint8Array}catch{t=!1}return t},e.wbg.__wbg_instanceof_Window_311934805c10047c=function(e){let t;try{t=a(e)instanceof Window}catch{t=!1}return t},e.wbg.__wbg_isArray_8738f1062fa88586=function(e){return Array.isArray(a(e))},e.wbg.__wbg_isSafeInteger_a1b3e0811faecf2f=function(e){return Number.isSafeInteger(a(e))},e.wbg.__wbg_iterator_c0c688f37fa815e6=function(){return y(Symbol.iterator)},e.wbg.__wbg_keys_45b15edb4089351e=function(e){return y(Object.keys(a(e)))},e.wbg.__wbg_length_12246a78d2f65d3a=function(e){return a(e).length},e.wbg.__wbg_length_c24da17096edfe57=function(e){return a(e).length},e.wbg.__wbg_mark_2e459508e2ea726f=function(){return h((function(e,t,n){a(e).mark(v(t,n))}),arguments)},e.wbg.__wbg_measure_590e79f6f28bcf70=function(){return h((function(e,t,n,r,_){a(e).measure(v(t,n),v(r,_))}),arguments)},e.wbg.__wbg_msCrypto_0a36e2ec3a343d26=function(e){return y(a(e).msCrypto)},e.wbg.__wbg_new_34d6bef95c8fdd30=function(){return y(new o)},e.wbg.__wbg_new_518e2184725aa711=function(){return y(new Map)},e.wbg.__wbg_new_59845962d1127937=function(e){return y(new Uint8Array(a(e)))},e.wbg.__wbg_new_67abf4a77618ee3e=function(){return y(new Object)},e.wbg.__wbg_new_8a6f238a6ece86ea=function(){return y(new Error)},e.wbg.__wbg_new_ac7361beaf933ba6=function(e,t){try{var n={a:e,b:t};let r=new Promise(((e,t)=>{let r=n.a;n.a=0;try{return function(e,t,n,r){i.__wbindgen_export_7(e,t,y(n),y(r))}(r,n.b,e,t)}finally{n.a=r}}));return y(r)}finally{n.a=n.b=0}},e.wbg.__wbg_new_e2d07398d7689006=function(){return y(new Array)},e.wbg.__wbg_newnoargs_a136448eeb7d48ac=function(e,t){return y(new Function(v(e,t)))},e.wbg.__wbg_newwithbyteoffsetandlength_84908302a4c137cf=function(e,t,n){return y(new Uint8Array(a(e),t>>>0,n>>>0))},e.wbg.__wbg_newwithlength_4c216eaaf23f2f9a=function(e){return y(new Uint8Array(e>>>0))},e.wbg.__wbg_next_928df8c15fc0c9b0=function(e){return y(a(e).next)},e.wbg.__wbg_next_9dc0926f351c7090=function(){return h((function(e){return y(a(e).next())}),arguments)},e.wbg.__wbg_node_02999533c4ea02e3=function(e){return y(a(e).node)},e.wbg.__wbg_now_c893509b6d04fa0d=function(e){return a(e).now()},e.wbg.__wbg_parse_bd09af51fd7dd576=function(){return h((function(e,t){return y(JSON.parse(v(e,t)))}),arguments)},e.wbg.__wbg_performance_69882c3bda965f91=function(e){let t=a(e).performance;return x(t)?0:y(t)},e.wbg.__wbg_process_5c1d670bc53614b8=function(e){return y(a(e).process)},e.wbg.__wbg_push_e7d7247e69dad3ee=function(e,t){return a(e).push(a(t))},e.wbg.__wbg_queueMicrotask_6808622725a52272=function(e){return y(a(e).queueMicrotask)},e.wbg.__wbg_queueMicrotask_ef0e86b0263a71ee=function(e){queueMicrotask(a(e))},e.wbg.__wbg_randomFillSync_ab2cfe79ebbf2740=function(){return h((function(e,t){a(e).randomFillSync(A(t))}),arguments)},e.wbg.__wbg_reject_fd3a67e45841ae99=function(e){return y(Promise.reject(a(e)))},e.wbg.__wbg_require_79b1e9274cde3c87=function(){return h((function(){return y(module.require)}),arguments)},e.wbg.__wbg_resolve_267ff08e7e1d2ce4=function(e){return y(Promise.resolve(a(e)))},e.wbg.__wbg_self_cca3ca60d61220f4=function(){return h((function(){return y(self.self)}),arguments)},e.wbg.__wbg_set_393f510a6b7e9da5=function(e,t,n){return y(a(e).set(a(t),a(n)))},e.wbg.__wbg_set_3f1d0b984ed272ed=function(e,t,n){a(e)[A(t)]=A(n)},e.wbg.__wbg_set_5deee49b10b2b780=function(e,t,n){a(e).set(a(t),n>>>0)},e.wbg.__wbg_set_93ba9407b5476ec6=function(e,t,n){a(e)[t>>>0]=A(n)},e.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){let n=g(a(t).stack,i.__wbindgen_export_0,i.__wbindgen_export_1),r=c;d().setInt32(e+4,r,!0),d().setInt32(e+0,n,!0)},e.wbg.__wbg_startTime_06f7b6aebc293aff=function(e){return a(e).startTime},e.wbg.__wbg_stringify_841980d1bf485619=function(){return h((function(e){return y(JSON.stringify(a(e)))}),arguments)},e.wbg.__wbg_subarray_2dc34705c0dc7cdb=function(e,t,n){return y(a(e).subarray(t>>>0,n>>>0))},e.wbg.__wbg_table_new=function(e){return y(R.__wrap(e))},e.wbg.__wbg_then_84907e7a6730461e=function(e,t){return y(a(e).then(a(t)))},e.wbg.__wbg_then_db12746ab6cec3f6=function(e,t,n){return y(a(e).then(a(t),a(n)))},e.wbg.__wbg_toString_2a965b6fc5a7e89f=function(e){return y(a(e).toString())},e.wbg.__wbg_trace_04e683e452168e85=function(e,t,n,r){console.trace(a(e),a(t),a(n),a(r))},e.wbg.__wbg_trace_bf1357f2a705e4dd=function(e){console.trace(a(e))},e.wbg.__wbg_value_51f8a88d4a1805fb=function(e){return y(a(e).value)},e.wbg.__wbg_values_9b070f5059e8183e=function(e){return y(Object.values(a(e)))},e.wbg.__wbg_versions_c71aa1626a93e0a1=function(e){return y(a(e).versions)},e.wbg.__wbg_view_new=function(e){return y(F.__wrap(e))},e.wbg.__wbg_view_unwrap=function(e){return F.__unwrap(A(e))},e.wbg.__wbg_warn_4f29d3e20ba97cd0=function(e,t,n,r){console.warn(a(e),a(t),a(n),a(r))},e.wbg.__wbg_warn_fecc8e96c5e56fb2=function(e){console.warn(a(e))},e.wbg.__wbg_window_2aba046d3fc4ad7c=function(){return h((function(){return y(window.window)}),arguments)},e.wbg.__wbindgen_as_number=function(e){return+a(e)},e.wbg.__wbindgen_bigint_from_i64=function(e){return y(e)},e.wbg.__wbindgen_bigint_from_u64=function(e){return y(BigInt.asUintN(64,e))},e.wbg.__wbindgen_bigint_get_as_i64=function(e,t){let n=a(t),r="bigint"==typeof n?n:void 0;d().setBigInt64(e+8,x(r)?BigInt(0):r,!0),d().setInt32(e+0,!x(r),!0)},e.wbg.__wbindgen_boolean_get=function(e){let t=a(e);return"boolean"==typeof t?t?1:0:2},e.wbg.__wbindgen_cb_drop=function(e){let t=A(e).original;return 1==t.cnt--&&(t.a=0,!0)},e.wbg.__wbindgen_closure_wrapper3058=function(e,t,n){let r=function(e,t,n,r){let _={a:e,b:t,cnt:1,dtor:n},o=function(){_.cnt++;let e=_.a;_.a=0;try{for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r(e,_.b,...n)}finally{0==--_.cnt?(i.__wbindgen_export_4.get(_.dtor)(e,_.b),k.unregister(_)):_.a=e}};return o.original=_,k.register(o,_,_),o}(e,t,436,W);return y(r)},e.wbg.__wbindgen_closure_wrapper373=function(e,t,n){let r=function(e,t,n,r){let _={a:e,b:t,cnt:1,dtor:n},o=function(){_.cnt++;try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r(_.a,_.b,...t)}finally{0==--_.cnt&&(i.__wbindgen_export_4.get(_.dtor)(_.a,_.b),_.a=0,k.unregister(_))}};return o.original=_,k.register(o,_,_),o}(e,t,4,O);return y(r)},e.wbg.__wbindgen_debug_string=function(e,t){let n=g(E(a(t)),i.__wbindgen_export_0,i.__wbindgen_export_1),r=c;d().setInt32(e+4,r,!0),d().setInt32(e+0,n,!0)},e.wbg.__wbindgen_error_new=function(e,t){return y(new Error(v(e,t)))},e.wbg.__wbindgen_in=function(e,t){return a(e)in a(t)},e.wbg.__wbindgen_is_bigint=function(e){return"bigint"==typeof a(e)},e.wbg.__wbindgen_is_function=function(e){return"function"==typeof a(e)},e.wbg.__wbindgen_is_object=function(e){let t=a(e);return"object"==typeof t&&null!==t},e.wbg.__wbindgen_is_string=function(e){return"string"==typeof a(e)},e.wbg.__wbindgen_is_undefined=function(e){return void 0===a(e)},e.wbg.__wbindgen_jsval_eq=function(e,t){return a(e)===a(t)},e.wbg.__wbindgen_jsval_loose_eq=function(e,t){return a(e)==a(t)},e.wbg.__wbindgen_memory=function(){return y(i.memory)},e.wbg.__wbindgen_number_get=function(e,t){let n=a(t),r="number"==typeof n?n:void 0;d().setFloat64(e+8,x(r)?0:r,!0),d().setInt32(e+0,!x(r),!0)},e.wbg.__wbindgen_number_new=function(e){return y(e)},e.wbg.__wbindgen_object_clone_ref=function(e){return y(a(e))},e.wbg.__wbindgen_object_drop_ref=function(e){A(e)},e.wbg.__wbindgen_string_get=function(e,t){let n=a(t),r="string"==typeof n?n:void 0;var _=x(r)?0:g(r,i.__wbindgen_export_0,i.__wbindgen_export_1),o=c;d().setInt32(e+4,o,!0),d().setInt32(e+0,_,!0)},e.wbg.__wbindgen_string_new=function(e,t){return y(v(e,t))},e.wbg.__wbindgen_throw=function(e,t){throw new Error(v(e,t))},e}function T(e,t){return i=e.exports,q.__wbindgen_wasm_module=t,l=null,u=null,i}function z(e){if(void 0!==i)return i;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));let t=C();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),T(new WebAssembly.Instance(e,t),e)}async function q(e){if(void 0!==i)return i;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead"));let t=C();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));let{instance:n,module:r}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(r){if("application/wasm"==e.headers.get("Content-Type"))throw r;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",r)}let n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{let n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return T(n,r)}var H=q;async function $(e,t,n){let r,_;async function i(){if(_?.readyState===e.CONNECTING||_?.readyState===e.OPEN)return void console.warn(`Already connected ${_.readyState}`);let[t,o,s]=function(){let e,t,n=new Promise(((n,r)=>{e=n,t=r}));return[e,n,t]}();_=new e(n),_.onopen=t,_.binaryType="arraybuffer",_.onerror=e=>{r.handle_error("WebSocket error",i),s("WebSocket error")},_.onclose=e=>{let t=`WebSocket closed ${e.code}`;r.handle_error(t,i),s(t)},_.onmessage=e=>{r.handle_response(e.data)},await o}return r=new t((async function(t){if(_.readyState===e.CLOSING||_.readyState===e.CLOSED){let e=`WebSocket transport error (${_.readyState})`;throw r.handle_error(e,i),new Error(e)}if(_.readyState===e.CONNECTING){let e=`WebSocket message dropped (${_.readyState})`;throw new Error(e)}{let e=t.slice().buffer;_.send(e)}}),(async function(){console.debug("Closing WebSocket"),_.close()})),await i(),await r.init(),r}async function D(e,t){let[n,r]=function(){let e,t,n=new Promise(((n,r)=>{e=n,t=r}));return[e,n,t]}();e.addEventListener("message",(function t(r){e.removeEventListener("message",t),n(null)})),e.onmessage=function(t){e.onmessage=function(){},n(null)},e.onmessageerror=console.error,e.postMessage({cmd:"init",args:[t]},{transfer:t instanceof WebAssembly.Module?[]:[t]}),await r}if(typeof WebAssembly>"u")throw new Error("WebAssembly not supported.");async function V(e){e instanceof Function&&(e=await e());try{let t=await async function(e){return e instanceof Response?(await WebAssembly.instantiateStreaming(e)).instance.exports:e instanceof WebAssembly.Module?(await WebAssembly.instantiate(e)).exports:e instanceof WebAssembly.Instance?e.exports:e instanceof ArrayBuffer?(await WebAssembly.instantiate(e)).instance.exports:e}(e),n=t.size(),r=t.offset();return new Uint8Array(t.memory.buffer).slice(r,r+n)}catch{return console.warn("Stage 0 wasm loading failed, skipping"),new Uint8Array(e)}}var G='"use strict";(()=>{var B=Object.defineProperty;var I=(n,t,r)=>t in n?B(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r;var d=(n,t,r)=>(I(n,typeof t!="symbol"?t+"":t,r),r);var g=class{constructor(t){d(this,"clients");d(this,"server");d(this,"module");this.clients=new Map,this.module=t,this.server=t._psp_new_server()}make_session(t){let r=this.module._psp_new_session(this.server);return this.clients.set(r,t),new h(this.module,this.server,r,this.clients)}delete(){this.module._psp_delete_server(this.server)}},h=class{constructor(t,r,a,i){this.mod=t;this.server=r;this.client_id=a;this.client_map=i}async handle_request(t){let r=await x(this.mod,t,async a=>this.mod._psp_handle_request(this.server,this.client_id,a,this.mod._psp_is_memory64()?BigInt(t.byteLength):t.byteLength));await A(this.mod,r,async a=>{await this.client_map.get(a.client_id)(a.data)})}poll(){let t=this.mod._psp_poll(this.server);A(this.mod,t,async r=>{await this.client_map.get(r.client_id)(r.data)})}close(){this.mod._psp_close_session(this.server,this.client_id)}};async function x(n,t,r){let a=n._psp_alloc(n._psp_is_memory64()?BigInt(t.byteLength):t.byteLength);n.HEAPU8.set(t,Number(a));let i=await r(a);return n._psp_free(a),i}async function A(n,t,r){let a=n._psp_is_memory64(),i=new DataView(n.HEAPU8.buffer,Number(t),a?12:8),c=i.getUint32(0,!0),l=a?i.getBigInt64(4,!0):i.getUint32(4,!0),e=new DataView(n.HEAPU8.buffer,Number(l),c*(a?16:12));try{for(let s=0;s<c;s++){let[o,p,f]=a?[e.getBigInt64(s*16,!0),e.getInt32(s*16+8,!0),e.getInt32(s*16+12,!0)]:[e.getInt32(s*12,!0),e.getInt32(s*12+4,!0),e.getInt32(s*12+8,!0)],_=new Uint8Array(n.HEAPU8.buffer,Number(o),p);await r({client_id:f,data:_})}}finally{for(let s=0;s<c;s++){let o=a?e.getBigInt64(s*16,!0):e.getInt32(s*12,!0);n._psp_free(o)}n._psp_free(a?BigInt(e.byteOffset):e.byteOffset),n._psp_free(a?BigInt(i.byteOffset):i.byteOffset)}}var H=console.log.bind(console),N=console.error.bind(console),L=new TextDecoder("utf8"),S=[null,[],[]];function j(n,t=0,r=NaN){for(var a=t+r,i=t;n[i]&&!(i>=a);)++i;return L.decode(n instanceof Uint8Array?n.subarray(t,i):new Uint8Array(n.slice(t,i)))}function P(n,t){var r=S[n];t===0||t===10?((n===1?H:N)(j(r,0)),r.length=0):r.push(t)}async function U(n){let t,r=!1,a,i={HaveOffsetConverter(){console.error("HaveOffsetConverter")},__syscall_ftruncate64(...e){console.error("__syscall_frtuncate64",e)},__syscall_getdents64(...e){console.error("__syscall_frtuncate64",e)},__syscall_unlinkat(...e){console.error("__syscall_frtuncate64",e)},__throw_exception_with_stack_trace(e){let s=new WebAssembly.Exception(t.__cpp_exception,[e],{traceStack:!0});throw s.message="Unexpected internal error",s},clock_time_get(e,s,o){if(r){if(o=o,o=Number(o),!(e==0||e==1||e==2||e==3))return 28;var p;e===0?p=Date.now():p=performance.now();let _=Math.round(p*1e3*1e3),u=new BigInt64Array(a.buffer);return u[o/8]=BigInt(_),0}else{if(o=o,o>>>=0,!(e==0||e==1||e==2||e==3))return 28;var p;e===0?p=Date.now():p=performance.now();var f=Math.round(p*1e6);let u=new BigInt64Array(a.buffer);return u[o>>>3]=BigInt(f),0}},emscripten_asm_const_int(...e){return 0},emscripten_notify_memory_growth(e){r?e=Number(e):(e=e,e>>>=0),e!=0&&console.error("abort")},environ_get(...e){return 0},environ_sizes_get(...e){return 0},fd_close(...e){return console.error("fd_close",e),0},fd_read(...e){return console.error("fd_read",e),0},fd_seek(...e){return console.error("fs_seek",e),0},fd_write(e,s,o,p){let f=new Uint8Array(a.buffer);if(r){s=Number(s),o=Number(o),p=Number(p);let _=0,u=new BigUint64Array(a.buffer);for(let y=0;y<o;y++){let v=Number(u[s/8]),b=Number(u[(s+8)/8]);s+=16;for(let m=0;m<b;m++)P(e,f[v+m]);_+=b}return u[p/8]=BigInt(_),0}else{s=s,o=o,p=p,s>>>=0,o>>>=0,p>>>=0;let _=0,u=new Uint32Array(a.buffer);for(let y=0;y<o;y++){let v=u[s>>>2>>>0],b=u[s+4>>>2>>>0];s+=8;for(let m=0;m<b;m++)P(e,f[v+m>>>0]);_+=b}return u[p>>>2>>>0]=_,0}},proc_exit(e){return console.error("proc_exit",e),0}},c=await n.instantiateWasm({env:i,wasi_snapshot_preview1:i},e=>{t=e.exports,r=!!t.psp_is_memory64(),a=e.exports.memory,t._initialize()}),l={};for(let[e,s]of Object.entries(c))l[`_${e}`]=s;return{...c,...l,get HEAPU8(){return new Uint8Array(a.buffer)}}}async function E(n){let t=await U({locateFile(r){return r},instantiateWasm:async(r,a)=>{r.env={...r.env,psp_stack_trace(){let c=Error().stack||"",e=new TextEncoder().encode(c),s=t._psp_alloc(t._psp_is_memory64()?BigInt(e.byteLength+1):e.byteLength+1);return t.HEAPU8.set(e,Number(s)),t.HEAPU8[Number(s)+e.byteLength]=0,s},psp_heap_size(){return t._psp_is_memory64()?BigInt(t.HEAPU8.buffer.byteLength):t.HEAPU8.buffer.byteLength}};let i=await WebAssembly.instantiate(n,r);return a(i.instance),i.instance.exports}});return t}var w;function M(n){let t=n.ports[0],r;t.addEventListener("message",async a=>{if(a.data.cmd==="init"){let i=a.data.id;if(!w){let c=await E(a.data.args[0]);w=new g(c)}r=w.make_session(async c=>{let l=c.slice().buffer;t.postMessage(l,{transfer:[l]})}),t.postMessage({id:i})}else r.handle_request(new Uint8Array(a.data)),setTimeout(()=>r.poll())}),t.start()}self.addEventListener("connect",M);self.addEventListener("message",M);})();\n';function J(e,t){return{addEventListener:function(t,n){e.push(n)},removeEventListener:function(t){let n=e.indexOf(t);n>-1&&e.splice(n,1)},postMessage:function(e){for(let n of t)n({data:e})},location:{href:""}}}var K,Q,X,Y=async function(){try{if(window.location.protocol.startsWith("file"))return console.warn("file:// protocol does not support Web Workers"),function(e){console.error("Running perspective in single-threaded mode");let t=[],n=[];return Function("const self = arguments[0];"+e)(J(t,n)),J(n,t)}(G);{let e=new Blob([G],{type:"application/javascript"}),t=URL.createObjectURL(e);return new Worker(t,{type:"module"})}}catch(e){console.error("Error instantiating engine",e)}};function Z(e,t){void 0===t&&(t=!1),K=e instanceof Uint8Array?Promise.resolve(e.buffer):e instanceof Response?e.arrayBuffer():e instanceof Promise?e.then((e=>e instanceof Response?e.arrayBuffer():e)):Promise.resolve(e),t||(K=K.then((e=>V(e).then((e=>e.buffer)))))}async function ee(e,t){void 0===t&&(t=!1);let n=t?e:await V(e);return await H(n),await j(),_}function te(e,t){void 0===t&&(t=!1),e instanceof Uint8Array?Q=ee(e.buffer,t):e instanceof ArrayBuffer?Q=ee(e,t):e instanceof Response?Q=e.arrayBuffer().then((e=>ee(e,t))):e instanceof Promise?Q=e.then((e=>e instanceof ArrayBuffer?ee(e,t):e instanceof Response?e.arrayBuffer().then((e=>ee(e,t))):e)):e instanceof Object&&(Q=Promise.resolve(e))}function ne(){let e=customElements.get("perspective-viewer");if(e)Q=Promise.resolve(e.__wasm_module__);else if(void 0===Q)throw new Error("Missing perspective-client.wasm");return Q}async function re(e){return await async function(e,t){let{Client:n}=await e;return await $(WebSocket,n,t)}(ne(),e)}async function _e(e){return typeof e>"u"&&(e=void 0===X?Y():X()),await async function(e,t,n){let r,[_,i]=await Promise.all([t,n]),{Client:o}=await e;if(i instanceof SharedWorker)r=i.port;else{let e=new MessageChannel;i.postMessage(null,[e.port2]),r=e.port1}let s=new o((async e=>{let t=e.slice().buffer;r.postMessage(t,{transfer:[t]})}),(async()=>{console.debug("Closing WebWorker"),r.close()}));return await D(r,_),r.addEventListener("message",(e=>{s.handle_response(e.data)})),await s.init(),s}(ne(),function(){if(void 0===K)throw new Error("Missing perspective-server.wasm");return K.then((e=>e instanceof WebAssembly.Module?e:e.slice(0)))}(),e)}var ie={websocket:re,worker:_e,init_client:te,init_server:Z}}}]);